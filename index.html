<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kanji Card Concentration</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- Settings Modal -->
    <div id="settingsModal" class="modal">
        <div class="modal-content">
            <span class="close">&times;</span>
            <h2>Game Settings</h2>
            <div class="setting-group">
                <label for="matchedPairBehavior">When pairs are matched:</label>
                <select id="matchedPairBehavior">
                    <option value="stay">Stay face up</option>
                    <option value="disappear">Disappear</option>
                </select>
            </div>
            <div class="setting-group">
                <label for="autoAdvance">Auto-advance from pre-game:</label>
                <input type="checkbox" id="autoAdvance">
            </div>
            <div class="setting-group">
                <label for="timerDuration">Pre-game timer (seconds):</label>
                <input type="number" id="timerDuration" min="10" max="300" value="60">
            </div>
            <button id="saveSettings">Save Settings</button>
        </div>
    </div>

    <!-- Print Cloze Settings Modal -->
    <div id="printClozeModal" class="modal">
        <div class="modal-content">
            <span class="close" id="printClozeClose">&times;</span>
            <h2>Print Cloze Settings</h2>
            <p>Choose what to hide in the printed study sheet for cloze practice:</p>
            
            <div class="setting-group">
                <label>
                    <input type="checkbox" id="hideRomajiFromMeaning" checked>
                    Hide romaji from meaning card
                </label>
            </div>
            
            <div class="setting-group">
                <label>
                    <input type="checkbox" id="hideHiraganaFromKanji" checked>
                    Hide hiragana from kanji card
                </label>
            </div>
            
            <div class="setting-group">
                <label>
                    <input type="checkbox" id="hideRomajiFromRhyme" checked>
                    Hide romaji from the rhyme
                </label>
            </div>
            
            <div class="setting-group">
                <label>
                    <input type="checkbox" id="hideKanjiFromKanji">
                    Hide kanji from kanji card
                </label>
            </div>
            
            <div class="setting-group">
                <label>
                    <input type="checkbox" id="hideEnglishFromMeaning">
                    Hide english from meaning card
                </label>
            </div>
            
            <div class="setting-group">
                <label>
                    <input type="checkbox" id="hideSentenceKanji">
                    Hide kanji from sentences
                </label>
            </div>
            
            <div class="setting-group">
                <label>
                    <input type="checkbox" id="hideSentenceRomaji">
                    Hide romaji from sentences
                </label>
            </div>
            
            <div class="setting-group">
                <label>
                    <input type="checkbox" id="hideSentenceEnglish">
                    Hide english from sentences
                </label>
            </div>
            
            <hr style="margin: 1.5rem 0; border: 1px solid #ddd;">
            <h3 style="text-align: center; color: #1e3c72; margin-bottom: 1rem;">Print Sentences Options</h3>
            
            <div class="setting-group">
                <label>
                    <input type="checkbox" id="hideSentencesRomaji">
                    Hide romaji from sentence sheets
                </label>
            </div>
            
            <div class="setting-group">
                <label>
                    <input type="checkbox" id="hideSentencesEnglish">
                    Hide English from sentence sheets
                </label>
            </div>
            
            <div class="modal-buttons">
                <button id="printWithCloze" class="control-btn">ğŸ–¨ï¸ Print Cards with Cloze</button>
                <button id="printNormal" class="control-btn">ğŸ–¨ï¸ Print Cards Normal</button>
                <button id="printSentencesWithOptions" class="control-btn">ğŸ“ Print Sentences</button>
            </div>
        </div>
    </div>

    <!-- Match Celebration Modal -->
    <div id="celebrationModal" class="modal celebration-modal">
        <div class="modal-content celebration-content">
            <span class="close" id="celebrationModalClose">&times;</span>
            <div class="celebration-text">
                <h2>Perfect Match!</h2>
                <div id="celebrationRhyme" class="rhyme-display"></div>
                <div id="celebrationSentence" class="sentence-display"></div>
                <div id="celebrationCards" class="celebration-cards"></div>
                <div class="sentence-controls">
                    <button id="toggleSentenceKanji" class="sentence-toggle-btn">ğŸ‘ï¸ Kanji</button>
                    <button id="toggleSentenceRomaji" class="sentence-toggle-btn">ğŸ‘ï¸ Romaji</button>
                    <button id="toggleSentenceEnglish" class="sentence-toggle-btn">ğŸ‘ï¸ English</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Review Modal -->
    <div id="reviewModal" class="modal">
        <div class="modal-content review-modal-content">
            <span class="close" id="reviewModalClose">&times;</span>
            <h2>Review Matched Pairs</h2>
            <div class="review-header">
                <div id="reviewCounter" class="review-counter">Pair 1 of 0</div>
                <div class="review-navigation">
                    <button id="prevPairBtn" class="nav-btn">â¬…ï¸ Previous</button>
                    <button id="nextPairBtn" class="nav-btn">Next â¡ï¸</button>
                </div>
            </div>
            <div id="reviewContent" class="review-content">
                <div id="reviewRhyme" class="review-rhyme"></div>
                <div id="reviewSentence" class="review-sentence"></div>
                <div id="reviewPairDisplay" class="review-pair-display">
                    <!-- Current pair will be displayed here -->
                </div>
                <div class="review-sentence-controls">
                    <button id="reviewToggleSentenceKanji" class="sentence-toggle-btn">ğŸ‘ï¸ Kanji</button>
                    <button id="reviewToggleSentenceRomaji" class="sentence-toggle-btn">ğŸ‘ï¸ Romaji</button>
                    <button id="reviewToggleSentenceEnglish" class="sentence-toggle-btn">ğŸ‘ï¸ English</button>
                </div>
            </div>
            <div class="review-footer">
                <p class="review-hint">Use arrow keys to navigate â€¢ Press Escape to close</p>
            </div>
        </div>
    </div>

    <!-- Main Game Container -->
    <div id="gameContainer">
        <!-- Header -->
        <header>
            <h1>Kanji Card Concentration</h1>
            <div class="header-controls">
                <button id="settingsBtn" class="control-btn">âš™ï¸ Settings</button>
                <button id="importBtn" class="control-btn">ğŸ“ Import Data</button>
                <button id="printCardsBtn" class="control-btn">ğŸ–¨ï¸ Print Cards</button>
                <button id="printRhymesBtn" class="control-btn">ğŸµ Print Rhymes</button>
                <button id="printSentencesBtn" class="control-btn">ğŸ“ Print Sentences</button>
                <button id="printCombinedBtn" class="control-btn">ğŸ“š Print Combined</button>
                <input type="file" id="fileInput" accept=".json" style="display: none;">
            </div>
        </header>

        <!-- Pre-game Screen (Now the first screen) -->
        <div id="preGameScreen" class="screen active">
            <div class="pre-game-header">
                <h2>Memorize the Card Pairs</h2>
                <div id="preGameTimer" class="timer"></div>
            </div>
            <div id="cardPairsDisplay" class="card-pairs-container">
                <!-- Card pairs will be dynamically generated here -->
            </div>
            <div class="pre-game-controls">
                <div class="flip-controls">
                    <button id="flipRomajiBtn" class="control-btn flip-btn">ğŸ”„ Hide Romaji/English</button>
                    <button id="flipKanjiBtn" class="control-btn flip-btn">ğŸ”„ Hide Kanji</button>
                    <button id="hideHiraganaBtn" class="control-btn flip-btn">ğŸ‘ï¸ Hide Hiragana</button>
                    <button id="resetFlipBtn" class="control-btn flip-btn">â†©ï¸ Show All Cards</button>
                    <button id="scrambleCardsBtn" class="control-btn flip-btn">ğŸ”€ Scramble Order</button>
                </div>
                <div class="card-selection-controls">
                    <button id="toggleCardSelectionBtn" class="control-btn selection-btn">â­ Select Specific Cards</button>
                    <button id="resetCardSelectionBtn" class="control-btn selection-btn" style="display: none;">ğŸ”„ Reset Selection</button>
                    <div id="selectionStatus" class="selection-status" style="display: none;">
                        <span id="selectedCount">0</span> cards selected
                    </div>
                </div>
                <button id="startGameBtn" class="start-btn">Choose Game Mode</button>
            </div>
        </div>

        <!-- Game Mode Selection Screen -->
        <div id="gameModeScreen" class="screen">
            <div class="mode-selection-header">
                <h2>Choose Your Game Mode</h2>
                <p>Select how you want to practice your kanji cards</p>
            </div>
            <div class="mode-options">
                <div class="mode-card" id="memoryMode">
                    <div class="mode-icon">ğŸ§ </div>
                    <h3>Memory Screen</h3>
                    <p>Study and memorize the card pairs before playing games</p>
                    <button class="mode-btn">Study Cards</button>
                </div>
                <div class="mode-card" id="concentrationMode">
                    <div class="mode-icon">ğŸ´</div>
                    <h3>Concentration Game</h3>
                    <p>Classic memory matching game with kanji and romaji cards</p>
                    <button class="mode-btn">Play Concentration</button>
                </div>
                <div class="mode-card" id="dragDropMode">
                    <div class="mode-icon">ğŸ¯</div>
                    <h3>Drag & Drop Match</h3>
                    <p>Drag kanji cards to match with English/romaji phrases</p>
                    <button class="mode-btn">Play Drag & Drop</button>
                </div>
                <div class="mode-card" id="storyMode">
                    <div class="mode-icon">ğŸ“–</div>
                    <h3>Story Mode</h3>
                    <p>Read a coherent story using all vocabulary words in context</p>
                    <button class="mode-btn">Read Story</button>
                </div>
            </div>
        </div>

        <!-- Drag & Drop Screen -->
        <div id="dragDropScreen" class="screen">
            <div class="drag-drop-header">
                <div class="round-info">
                    <h2 id="dragDropTitle">Drag & Drop Match</h2>
                    <p id="dragDropDescription">Drag kanji cards to match with English/romaji phrases</p>
                </div>
                <div class="game-stats">
                    <div class="score-display">
                        <span id="dragDropScore" class="score-value">Score: 1000</span>
                        <span id="dragDropScoreChange" class="score-change"></span>
                    </div>
                    <span id="dragDropMatches">Matches: 0/52</span>
                    <span id="dragDropAttempts">Attempts: 0</span>
                </div>
            </div>
            
                <div class="drag-drop-controls">
                    <button id="hideEnglishBtn" class="control-btn toggle-btn">ğŸ‘ï¸ Hide English</button>
                    <button id="hideRhymeBtn" class="control-btn toggle-btn">ğŸµ Hide Rhymes</button>
                    <button id="hideSentencesBtn" class="control-btn toggle-btn">ğŸ“ Hide Sentences</button>
                    <button id="dragDropResetBtn" class="control-btn">ğŸ”„ Reset</button>
                    <button id="dragDropBackBtn" class="control-btn">ğŸ“š Back to Study</button>
                    <button id="backToModeSelectBtn" class="control-btn">ğŸ  Mode Select</button>
                </div>

            <div id="dragDropGameArea" class="drag-drop-game-area">
                <!-- Left side: English/Romaji cards with rhymes -->
                <div id="dragDropTargets" class="drag-drop-targets">
                    <h3>Match the Kanji Cards</h3>
                    <div id="targetCardsContainer" class="target-cards-container">
                        <!-- Target cards will be generated here -->
                    </div>
                </div>
                
                <!-- Right side: Scrollable kanji cards -->
                <div id="dragDropSource" class="drag-drop-source">
                    <h3>Kanji Cards</h3>
                    <div id="sourceCardsContainer" class="source-cards-container">
                        <!-- Draggable kanji cards will be generated here -->
                    </div>
                </div>
            </div>
        </div>

        <!-- Story Screen -->
        <div id="storyScreen" class="screen">
            <div class="story-header">
                <h2>Story Mode</h2>
                <p>Read the vocabulary words in a coherent story</p>
                <div class="story-controls">
                    <button id="hideStoryRomajiBtn" class="control-btn">ğŸ™ˆ Hide Romaji</button>
                    <button id="hideStoryEnglishBtn" class="control-btn">ğŸ™ˆ Hide English</button>
                    <button id="printStoryBtn" class="control-btn">ğŸ–¨ï¸ Print Story</button>
                    <button id="backToModeSelectFromStory" class="control-btn">ğŸ  Mode Select</button>
                </div>
            </div>
            
            <div id="storyContent" class="story-content">
                <div id="storyText" class="story-text">
                    <!-- Story will be generated here -->
                </div>
            </div>
        </div>

        <!-- Game Screen -->
        <div id="gameScreen" class="screen">
            <div class="game-header">
                <div class="round-info">
                    <h2 id="roundTitle">Round 1</h2>
                    <p id="roundDescription">Rank + Suit + Content</p>
                </div>
                <div class="game-stats">
                    <div class="score-display">
                        <span id="currentScore" class="score-value">Score: 1000</span>
                        <span id="scoreChange" class="score-change"></span>
                    </div>
                    <span id="matchesFound">Matches: 0/52</span>
                    <span id="attempts">Attempts: 0</span>
                </div>
            </div>
            
            <div class="game-controls">
                <button id="resetBtn" class="control-btn">ï¿½ Reset</button>
                <button id="prevRoundBtn" class="control-btn">â¬…ï¸ Previous Round</button>
                <button id="nextRoundBtn" class="control-btn">â¡ï¸ Next Round</button>
                <button id="restrictBoardBtn" class="control-btn special-btn">ğŸ¯ 4-Card Focus (-50 pts)</button>
                <button id="reviewBtn" class="control-btn">ğŸ“– Review Matches</button>
                <button id="backToPreGameBtn" class="control-btn">ğŸ“š Back to Study</button>
            </div>

            <div id="gameBoard" class="game-board">
                <!-- Game cards will be dynamically generated here -->
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
